/**
 * node -r dotenv/config gemini/debug.js
 */

import { GoogleGenAI } from '@google/genai'
import { inspect } from 'util'

const ai = new GoogleGenAI({
  apiKey: process.env.GEMINI_API_KEY,
})

async function main() {
  const generateContentParams = {
    model: 'gemini-2.5-flash',
    contents: [
      {
        parts: [
          {
            text: 'What is the weather like in Paris (48.8575° N, 2.3514° E) today?'
          }
        ],
        role: 'user'
      },
      {
        parts: [
          {
            functionCall: {
              args: {
                latitude: 48.8575,
                location: 'Paris, France',
                longitude: 2.3514
              },
              name: 'OU6GLwOYeQjLz7KXQ5i'
            }
          }
        ],
        role: 'model'
      },
      {
        parts: [
          {
            functionResponse: {
              name: 'OU6GLwOYeQjLz7KXQ5i',
              response: {
                content: '{\\"latitude\\":48.86,\\"longitude\\":2.3599997,\\"generationtime_ms\\":0.11527538299560547,\\"utc_offset_seconds\\":0,\\"timezone\\":\\"GMT\\",\\"timezone_abbreviation\\":\\"GMT\\",\\"elevation\\":49.0,\\"current_units\\":{\\"time\\":\\"iso8601\\",\\"interval\\":\\"seconds\\",\\"temperature_2m\\":\\"°C\\",\\"wind_speed_10m\\":\\"km/h\\"},\\"current\\":{\\"time\\":\\"2025-08-23T09:30\\",\\"interval\\":900,\\"temperature_2m\\":18.8,\\"wind_speed_10m\\":6.0},\\"hourly_units\\":{\\"time\\":\\"iso8601\\",\\"temperature_2m\\":\\"°C\\",\\"relative_humidity_2m\\":\\"%\\",\\"wind_speed_10m\\":\\"km/h\\"},\\"hourly\\":{\\"time\\":[\\"2025-08-23T00:00\\",\\"2025-08-23T01:00\\",\\"2025-08-23T02:00\\",\\"2025-08-23T03:00\\",\\"2025-08-23T04:00\\",\\"2025-08-23T05:00\\",\\"2025-08-23T06:00\\",\\"2025-08-23T07:00\\",\\"2025-08-23T08:00\\",\\"2025-08-23T09:00\\",\\"2025-08-23T10:00\\",\\"2025-08-23T11:00\\",\\"2025-08-23T12:00\\",\\"2025-08-23T13:00\\",\\"2025-08-23T14:00\\",\\"2025-08-23T15:00\\",\\"2025-08-23T16:00\\",\\"2025-08-23T17:00\\",\\"2025-08-23T18:00\\",\\"2025-08-23T19:00\\",\\"2025-08-23T20:00\\",\\"2025-08-23T21:00\\",\\"2025-08-23T22:00\\",\\"2025-08-23T23:00\\",\\"2025-08-24T00:00\\",\\"2025-08-24T01:00\\",\\"2025-08-24T02:00\\",\\"2025-08-24T03:00\\",\\"2025-08-24T04:00\\",\\"2025-08-24T05:00\\",\\"2025-08-24T06:00\\",\\"2025-08-24T07:00\\",\\"2025-08-24T08:00\\",\\"2025-08-24T09:00\\",\\"2025-08-24T10:00\\",\\"2025-08-24T11:00\\",\\"2025-08-24T12:00\\",\\"2025-08-24T13:00\\",\\"2025-08-24T14:00\\",\\"2025-08-24T15:00\\",\\"2025-08-24T16:00\\",\\"2025-08-24T17:00\\",\\"2025-08-24T18:00\\",\\"2025-08-24T19:00\\",\\"2025-08-24T20:00\\",\\"2025-08-24T21:00\\",\\"2025-08-24T22:00\\",\\"2025-08-24T23:00\\",\\"2025-08-25T00:00\\",\\"2025-08-25T01:00\\",\\"2025-08-25T02:00\\",\\"2025-08-25T03:00\\",\\"2025-08-25T04:00\\",\\"2025-08-25T05:00\\",\\"2025-08-25T06:00\\",\\"2025-08-25T07:00\\",\\"2025-08-25T08:00\\",\\"2025-08-25T09:00\\",\\"2025-08-25T10:00\\",\\"2025-08-25T11:00\\",\\"2025-08-25T12:00\\",\\"2025-08-25T13:00\\",\\"2025-08-25T14:00\\",\\"2025-08-25T15:00\\",\\"2025-08-25T16:00\\",\\"2025-08-25T17:00\\",\\"2025-08-25T18:00\\",\\"2025-08-25T19:00\\",\\"2025-08-25T20:00\\",\\"2025-08-25T21:00\\",\\"2025-08-25T22:00\\",\\"2025-08-25T23:00\\",\\"2025-08-26T00:00\\",\\"2025-08-26T01:00\\",\\"2025-08-26T02:00\\",\\"2025-08-26T03:00\\",\\"2025-08-26T04:00\\",\\"2025-08-26T05:00\\",\\"2025-08-26T06:00\\",\\"2025-08-26T07:00\\",\\"2025-08-26T08:00\\",\\"2025-08-26T09:00\\",\\"2025-08-26T10:00\\",\\"2025-08-26T11:00\\",\\"2025-08-26T12:00\\",\\"2025-08-26T13:00\\",\\"2025-08-26T14:00\\",\\"2025-08-26T15:00\\",\\"2025-08-26T16:00\\",\\"2025-08-26T17:00\\",\\"2025-08-26T18:00\\",\\"2025-08-26T19:00\\",\\"2025-08-26T20:00\\",\\"2025-08-26T21:00\\",\\"2025-08-26T22:00\\",\\"2025-08-26T23:00\\",\\"2025-08-27T00:00\\",\\"2025-08-27T01:00\\",\\"2025-08-27T02:00\\",\\"2025-08-27T03:00\\",\\"2025-08-27T04:00\\",\\"2025-08-27T05:00\\",\\"2025-08-27T06:00\\",\\"2025-08-27T07:00\\",\\"2025-08-27T08:00\\",\\"2025-08-27T09:00\\",\\"2025-08-27T10:00\\",\\"2025-08-27T11:00\\",\\"2025-08-27T12:00\\",\\"2025-08-27T13:00\\",\\"2025-08-27T14:00\\",\\"2025-08-27T15:00\\",\\"2025-08-27T16:00\\",\\"2025-08-27T17:00\\",\\"2025-08-27T18:00\\",\\"2025-08-27T19:00\\",\\"2025-08-27T20:00\\",\\"2025-08-27T21:00\\",\\"2025-08-27T22:00\\",\\"2025-08-27T23:00\\",\\"2025-08-28T00:00\\",\\"2025-08-28T01:00\\",\\"2025-08-28T02:00\\",\\"2025-08-28T03:00\\",\\"2025-08-28T04:00\\",\\"2025-08-28T05:00\\",\\"2025-08-28T06:00\\",\\"2025-08-28T07:00\\",\\"2025-08-28T08:00\\",\\"2025-08-28T09:00\\",\\"2025-08-28T10:00\\",\\"2025-08-28T11:00\\",\\"2025-08-28T12:00\\",\\"2025-08-28T13:00\\",\\"2025-08-28T14:00\\",\\"2025-08-28T15:00\\",\\"2025-08-28T16:00\\",\\"2025-08-28T17:00\\",\\"2025-08-28T18:00\\",\\"2025-08-28T19:00\\",\\"2025-08-28T20:00\\",\\"2025-08-28T21:00\\",\\"2025-08-28T22:00\\",\\"2025-08-28T23:00\\",\\"2025-08-29T00:00\\",\\"2025-08-29T01:00\\",\\"2025-08-29T02:00\\",\\"2025-08-29T03:00\\",\\"2025-08-29T04:00\\",\\"2025-08-29T05:00\\",\\"2025-08-29T06:00\\",\\"2025-08-29T07:00\\",\\"2025-08-29T08:00\\",\\"2025-08-29T09:00\\",\\"2025-08-29T10:00\\",\\"2025-08-29T11:00\\",\\"2025-08-29T12:00\\",\\"2025-08-29T13:00\\",\\"2025-08-29T14:00\\",\\"2025-08-29T15:00\\",\\"2025-08-29T16:00\\",\\"2025-08-29T17:00\\",\\"2025-08-29T18:00\\",\\"2025-08-29T19:00\\",\\"2025-08-29T20:00\\",\\"2025-08-29T21:00\\",\\"2025-08-29T22:00\\",\\"2025-08-29T23:00\\"],\\"temperature_2m\\":[16.0,15.5,15.2,14.4,13.9,13.6,13.7,14.6,16.2,17.9,19.3,21.0,22.1,22.8,23.3,23.5,23.3,22.1,20.8,20.1,19.6,19.2,18.9,18.7,18.5,18.1,17.5,16.6,16.1,15.5,15.0,15.6,16.8,18.6,20.2,21.3,22.3,23.1,23.5,23.7,23.8,23.5,22.9,22.2,21.5,20.8,19.9,19.0,18.3,17.6,17.1,16.8,16.5,16.1,16.2,15.6,17.5,19.6,21.9,23.7,24.9,25.9,26.4,26.7,26.5,25.9,24.9,23.1,21.5,20.1,19.0,18.0,16.9,16.2,15.7,15.4,15.1,15.0,15.4,17.3,19.9,22.3,24.1,25.7,26.9,27.4,27.5,27.3,26.7,25.8,24.9,24.1,23.3,22.6,21.9,21.3,20.7,20.3,19.9,19.6,19.2,19.0,19.0,19.5,20.2,21.1,21.9,22.8,23.6,24.3,24.8,25.1,25.1,24.8,24.3,23.4,22.3,21.4,20.9,20.6,20.4,19.5,18.7,17.9,17.4,17.0,17.1,17.9,19.2,20.5,21.6,22.7,23.6,24.3,24.7,24.7,24.1,23.2,22.1,20.8,19.4,18.3,17.8,17.7,17.4,16.8,16.0,15.5,15.3,15.3,15.5,15.9,16.4,16.8,16.6,16.2,16.1,16.9,18.0,18.8,18.9,18.6,18.2,17.6,16.8,16.1,15.7,15.3],\\"relative_humidity_2m\\":[66,69,69,70,72,73,74,68,60,51,47,43,39,38,39,38,40,50,58,58,61,64,68,69,67,67,67,70,71,71,69,64,58,53,47,46,43,39,38,32,35,36,34,36,40,45,52,54,55,57,58,59,61,62,63,66,59,51,44,38,35,32,30,30,30,31,32,37,44,50,56,61,66,69,71,72,74,75,75,70,62,55,50,46,43,42,41,42,44,47,50,54,59,64,69,73,77,80,83,84,84,82,79,73,66,59,54,49,45,43,42,41,40,40,41,46,53,59,62,64,65,68,71,74,78,82,83,79,73,65,55,44,36,33,33,34,37,42,47,54,61,67,70,70,72,76,80,84,86,87,87,86,83,82,84,87,88,84,77,73,74,78,82,86,89,92,93,93],\\"wind_speed_10m\\":[5.2,5.7,5.0,4.9,4.7,5.6,5.6,6.1,5.1,6.6,5.8,4.4,5.4,5.8,5.5,5.9,6.1,12.2,10.5,8.0,6.6,5.9,5.2,5.3,5.7,5.4,5.2,4.8,3.9,4.0,5.4,5.9,5.6,5.9,6.6,7.0,6.6,6.8,7.1,8.4,7.5,7.4,6.3,6.5,4.5,4.1,4.8,4.2,4.1,2.9,2.4,1.1,1.6,2.6,1.8,3.1,3.2,5.2,6.1,6.3,7.5,7.9,8.0,7.9,8.1,8.4,7.7,5.4,4.1,3.6,3.3,3.8,3.6,3.8,3.8,4.1,4.1,3.8,3.6,4.3,6.5,7.7,8.0,9.2,11.4,12.4,12.4,11.8,10.7,9.3,8.0,6.8,5.4,4.2,2.9,1.8,2.2,3.3,5.4,6.6,7.0,6.5,6.5,7.2,8.5,9.7,10.4,11.5,12.0,12.5,12.5,12.5,12.0,10.9,10.0,8.2,6.8,6.3,6.9,8.0,9.3,9.3,7.1,5.9,5.9,6.5,7.6,8.9,11.0,12.8,13.9,14.6,15.3,15.7,16.4,16.3,15.8,15.1,13.5,10.4,6.9,5.8,7.2,10.0,11.9,11.8,11.3,10.4,9.8,9.3,9.6,10.5,12.0,13.0,12.9,12.4,10.8,7.3,5.6,8.1,9.0,9.0,8.3,7.6,6.6,5.5,5.2,4.9]}}'
              }
            }
          }
        ],
        role: 'user'
      },
      {
        parts: [
          {
            text: 'Here is the weather forecast for Paris today, August 23rd, 2025:\n' +
              '\n' +
              '**Current Conditions (as of 09:30 GMT):**\n' +
              '*   **Temperature:** 18.8°C\n' +
              '*   **Wind Speed:** 6.0 km/h\n' +
              '\n' +
              '**Hourly Forecast for the rest of today:**\n' +
              '*   **Morning (10:00 - 12:00):** Temperatures will rise from 19.3°C to 22.1°C. Humidity will be around 39-47%, and wind speeds will be light, ranging from 4.4 to 5.8 km/h.\n' +
              '*   **Afternoon (13:00 - 17:00):** The temperature will peak at 23.5°C around 15:00, then slightly drop to 22.1°C by 17:00. Humidity will be between 38-50%. Wind speeds will generally be around 5.5-6.1 km/h, but will increase to 12.2 km/h by 17:00.\n' +
              '*   **Evening (18:00 - 23:00):** Temperatures will gradually decrease from 20.8°C to 18.7°C. Humidity will increase, ranging from 58% to 69%. Wind speeds will decrease from 10.5 km/h to around 5.3 km/h.'
          }
        ],
        role: 'model'
      },
      {
        parts: [
          {
            text: 'Hello, my name is Oliver Dinh (first name is Oliver, last name is Dinh). My email is harrypotter@ideta.io. My phone number is 4242424242. I want to talk to an agent about an error on your platform.'
          }
        ],
        role: 'user'
      },
      {
        parts: [
          {
            functionCall: {
              args: {
                email: 'harrypotter@ideta.io',
                firstName: 'Oliver',
                lastName: 'Dinh'
              },
              name: 'Nj9Yn8D7ovTLtoAZGqY'
            }
          }
        ],
        role: 'model'
      },
      {
        parts: [
          {
            functionResponse: {
              name: 'Nj9Yn8D7ovTLtoAZGqY',
              response: { content: 'Some data was displayed to the user' }
            }
          }
        ],
        role: 'user'
      },
      {
        parts: [ { text: 'My phone number is 123123213' } ],
        role: 'user'
      },
      {
        role: 'model',
        parts: [
          {
            functionCall: {
              name: 'NjMi84x01DY8i7XXRk4',
              args: { phoneNumber: 123123213 }
            }
          }
        ]
      },
      {
        role: 'user',
        parts: [
          {
            functionResponse: {
              name: 'NjMi84x01DY8i7XXRk4',
              response: { content: 'Some data was displayed to the user' }
            }
          }
        ]
      },
      { role: 'user', parts: [ { text: "I'm from France" } ] }
    ],
    config: {
      temperature: 0.1,
      systemInstruction: {
        parts: [ { text: 'You are the virtual assistant for IDETA. ' } ]
      },
      safetySettings: [
        {
          category: 'HARM_CATEGORY_SEXUALLY_EXPLICIT',
          threshold: 'BLOCK_NONE'
        },
        {
          category: 'HARM_CATEGORY_HATE_SPEECH',
          threshold: 'BLOCK_NONE'
        },
        { category: 'HARM_CATEGORY_HARASSMENT', threshold: 'BLOCK_NONE' },
        {
          category: 'HARM_CATEGORY_DANGEROUS_CONTENT',
          threshold: 'BLOCK_NONE'
        }
      ]
    }
  }

  // const response = await ai.models.generateContent(generateContentParams)
  // console.log(inspect(response.candidates[0].content, { depth: null, colors: true }))

  // streaming
  const response = await ai.models.generateContentStream(generateContentParams)
  for await (const chunk of response) {
    console.log(chunk.text)
  }
}

await main()
